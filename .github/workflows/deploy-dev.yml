name: Deploy DB migrations (dev)

on:
  push:
    paths:
      - prisma/migrations/** # Only run this workflow when migrations are updated
    branches:
      - dev

jobs:
  deploy:
    runs-on: warp-ubuntu-latest-x64-8x
    steps:
      - uses: actions/checkout@v4
      - uses: oven-sh/setup-bun@v2
        with:
          bun-version-file: ".bun-version"
      - run: bun install
      - name: Apply all pending migrations to the database
        run: bun prisma migrate deploy
        env:
          DATABASE_URL: ${{ secrets.DATABASE_DEV_URL }}
